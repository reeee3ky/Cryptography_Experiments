```python
# coding=utf-8
from oracle import *

c = '9F0B13944841A832B2421B9EAF6D9836813EC9D944A5C8347A7CA69AA34D8DC0DF70E343C4000A2AE35874CE75E64C31'
block_num = 3
length = len(c) / block_num
Cry = []
for i in range(block_num):
	Cry.append(c[i * length : (i + 1) * length])
# print Cry[0], Cry[1], Cry[2]
Oracle_Connect()
# iv = ‘9F0B13944841A832B2421B9EAF6D9836’
# cry1 = '813EC9D944A5C8347A7CA69AA34D8DC0'
# cry2 = 'DF70E343C4000A2AE35874CE75E64C31'
mess = ''
flag = 1
for i in range(1, block_num):
	IV = Cry[i - 1].decode('hex')
	Ivalue = ''
	for l in range(length / 2): # 爆破每一位 Ivalue (0~15)，总长度依次叠加
		iv = ''
		padding = l + 1 # 1~16
		for ll in range(l): # 根据已知 Ivalue 修改 iv
			iv += hex(ord(Ivalue.decode('hex')[ll]) ^ padding)[2:].zfill(2)
		
		for iv_test in range(256):
			iv = iv[0 : l * 2]
			iv += hex(iv_test)[2:].zfill(2)
			#print iv
			iv = iv.ljust(length, '0')
			#print iv
			data = iv.decode('hex')[::-1].encode('hex') + Cry[flag] 
			ctext = [(int(data[i:i+2],16)) for i in range(0, len(data), 2)]
			rc = Oracle_Send(ctext, 2)
			if str(rc) == '1': # padding 正确。根据 padding 值和此时 iv 计算 对应位置 Ivalue
				Ivalue += hex(padding ^ iv_test)[2:].zfill(2)
				print "Ivalue: ", Ivalue.ljust(length, '0').decode('hex')[::-1].encode('hex')
				break
		print "iv:     ", iv.decode('hex')[::-1].encode('hex')
		print '-' * 50
	Ivalue = Ivalue.decode('hex')[::-1]
	mess += "".join(chr(ord(x) ^ ord(y)) for x, y in zip(Ivalue, IV))
	print '=' * 70, '\n', mess, '\n', '=' * 70
	flag += 1

Oracle_Disconnect()
print mess
```

```
Connected to server successfully.
Ivalue:  00000000000000000000000000000016
iv:      00000000000000000000000000000017
--------------------------------------------------
Ivalue:  0000000000000000000000000000f616
iv:      0000000000000000000000000000f414
--------------------------------------------------
Ivalue:  000000000000000000000000000cf616
iv:      000000000000000000000000000ff515
--------------------------------------------------
Ivalue:  0000000000000000000000008f0cf616
iv:      0000000000000000000000008b08f212
--------------------------------------------------
Ivalue:  0000000000000000000000ea8f0cf616
iv:      0000000000000000000000ef8a09f313
--------------------------------------------------
Ivalue:  000000000000000000007eea8f0cf616
iv:      0000000000000000000078ec890af010
--------------------------------------------------
Ivalue:  000000000000000000257eea8f0cf616
iv:      0000000000000000002279ed880bf111
--------------------------------------------------
Ivalue:  000000000000000092257eea8f0cf616
iv:      00000000000000009a2d76e28704fe1e
--------------------------------------------------
Ivalue:  000000000000004792257eea8f0cf616
iv:      000000000000004e9b2c77e38605ff1f
--------------------------------------------------
Ivalue:  000000000000c74792257eea8f0cf616
iv:      000000000000cd4d982f74e08506fc1c
--------------------------------------------------
Ivalue:  000000000018c74792257eea8f0cf616
iv:      000000000013cc4c992e75e18407fd1d
--------------------------------------------------
Ivalue:  000000006818c74792257eea8f0cf616
iv:      000000006414cb4b9e2972e68300fa1a
--------------------------------------------------
Ivalue:  000000b56818c74792257eea8f0cf616
iv:      000000b86515ca4a9f2873e78201fb1b
--------------------------------------------------
Ivalue:  00006ab56818c74792257eea8f0cf616
iv:      000064bb6616c9499c2b70e48102f818
--------------------------------------------------
Ivalue:  006a6ab56818c74792257eea8f0cf616
iv:      006565ba6717c8489d2a71e58003f919
--------------------------------------------------
Ivalue:  c66a6ab56818c74792257eea8f0cf616
iv:      d67a7aa57808d75782356efa9f1ce606
--------------------------------------------------
====================================================================== 
Yay! You get an  
======================================================================
Ivalue:  000000000000000000000000000000cb
iv:      000000000000000000000000000000ca
--------------------------------------------------
Ivalue:  000000000000000000000000000086cb
iv:      000000000000000000000000000084c9
--------------------------------------------------
Ivalue:  000000000000000000000000004686cb
iv:      000000000000000000000000004585c8
--------------------------------------------------
Ivalue:  000000000000000000000000a84686cb
iv:      000000000000000000000000ac4282cf
--------------------------------------------------
Ivalue:  000000000000000000000091a84686cb
iv:      000000000000000000000094ad4383ce
--------------------------------------------------
Ivalue:  00000000000000000000ad91a84686cb
iv:      00000000000000000000ab97ae4080cd
--------------------------------------------------
Ivalue:  00000000000000000077ad91a84686cb
iv:      00000000000000000070aa96af4181cc
--------------------------------------------------
Ivalue:  00000000000000007177ad91a84686cb
iv:      0000000000000000797fa599a04e8ec3
--------------------------------------------------
Ivalue:  000000000000003f7177ad91a84686cb
iv:      0000000000000036787ea498a14f8fc2
--------------------------------------------------
Ivalue:  000000000000c33f7177ad91a84686cb
iv:      000000000000c9357b7da79ba24c8cc1
--------------------------------------------------
Ivalue:  0000000000aec33f7177ad91a84686cb
iv:      0000000000a5c8347a7ca69aa34d8dc0
--------------------------------------------------
Ivalue:  000000006daec33f7177ad91a84686cb
iv:      0000000061a2cf337d7ba19da44a8ac7
--------------------------------------------------
Ivalue:  000000e46daec33f7177ad91a84686cb
iv:      000000e960a3ce327c7aa09ca54b8bc6                                                                                       
--------------------------------------------------                                                                               
Ivalue:  0000e9e46daec33f7177ad91a84686cb
iv:      0000e7ea63a0cd317f79a39fa64888c5
--------------------------------------------------
Ivalue:  0010e9e46daec33f7177ad91a84686cb
iv:      001fe6eb62a1cc307e78a29ea74989c4
--------------------------------------------------
Ivalue:  c010e9e46daec33f7177ad91a84686cb
iv:      d000f9f47dbed32f6167bd81b85696db
--------------------------------------------------
====================================================================== 
Yay! You get an A. =)
======================================================================
Connection closed successfully.
Yay! You get an A. =)
```

